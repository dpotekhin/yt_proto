"use strict";$(function(){var i=$('<div id="debug" style="position:fixed;top:0;left:0;background:black;color:red;font-size:20px;padding:0 10px;"></div>').appendTo("body");window._DEBUG=function(e){!0!==e?i.append("<p>"+e+"</p>"):i.empty()}});var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=requestAnimationFrame,$(function(){var e=$("body");if(e.length){var i=e.data("data");console.log("data_url: ",i),i?$.getJSON(i,function(e){$(window).trigger("page:ready",e),console.log("data: ",e)}):console.warn("data url required!")}}),$(function(){var e=$(".video-player");if(e.length){var n,o,i=$(window),t=!1,a=$("video",e)[0];enableInlineVideo(a),a.addEventListener("loadedmetadata",function(){a.currentTime=n},!1),console.log("video-player init",a),i.on("video-player:play",function(e,i){console.log("@video-player:play",i),o=i.end,a.src=i.url,n=i.start||0,a.play(),t=!0}),setInterval(function(){t&&o&&(_DEBUG(!0),_DEBUG(~~a.currentTime),n&&a.currentTime<n-1&&(a.currentTime=n),o&&a.currentTime>=o&&(t=!1,a.pause(),i.trigger("video-player:finished")))},40),i.trigger("video-player:ready")}}),$(window).on("page:ready",function(e,i){function n(){t([{title:"Start",click:o}])}function o(n){console.log("playNext: ",s),null!=n?s.videos.forEach(function(e,i){e.id==n&&(c=i)}):c++,d=s.videos[c],console.log("playNext: ",c,d),r.trigger("video-player:play",d)}function t(e){e.forEach(function(e,i){console.log("btn",e,i),$('<div class="select-button" data-video-id="'+e.video_id+'">'+e.title+"<div>").appendTo(l).click(function(){e.click?e.click():o($(this).data("video-id"));l.addClass("list-player__buttons_hidden"),setTimeout(function(){l.empty().hide()},400)})}),l.show().removeClass("list-player__buttons_hidden")}var a=$(".list-player");if(a.length){var d,r=$(window),l=$(".list-player__buttons",a),s=i,c=-1;l.hide().addClass("list-player__buttons_hidden"),n(),r.on("video-player:finished",function(e){console.log("FINISHED"),t(d.buttons)})}});