"use strict";var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=requestAnimationFrame,$(function(){var e=$("body");if(e.length){var t=e.data("data");console.log("data_url: ",t),t?$.getJSON(t,function(e){$(window).trigger("page:ready",e),console.log("data: ",e)}):console.warn("data url required!")}}),$(function(){function e(e){console.log("player! onPlayerReady"),c.trigger("yt-player:ready")}function t(e){switch(console.log("player! onPlayerStateChange",e,YT.PlayerState),e.data){case YT.PlayerState.UNSTARTED:y=!1;break;case YT.PlayerState.PLAYING:o(y=!0);break;case YT.PlayerState.ENDED:y&&n()}}function n(){o(y=!1),c.trigger("yt-player:finished")}function o(e,t){console.log("setVisibility",e),e?d.show():d.hide()}var a=$(".yt-player");if(a.length){console.log("yt-player init");var i=document.createElement("script");i.src="https://www.youtube.com/iframe_api";var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(i,l);var r,s,d=$(".yt-player__container",a),c=$(window),y=!1;o(!1),window.onYouTubeIframeAPIReady=function(){r=new YT.Player(d[0],{height:"100%",width:"100%",playerVars:{autoplay:0,controls:0,disablekb:1,modestbranding:1,playsinline:1,rel:0,showinfo:0,enablejsapi:1},events:{onReady:e,onStateChange:t}}),d=$(".yt-player__container",a),console.log("YT player is ready!",r),setInterval(function(){y&&s&&s&&r.getCurrentTime()>=s&&(n(),r.stopVideo())},40)},c.on("yt-player:play-by-id",function(e,t){t.videoId,s=t.endSeconds,r.loadVideoById(t)})}}),$(function(){function n(){--s<=0&&(console.log("all's set"),t([{title:"Start",click:o}]))}function o(n){console.log("playNext: ",a),null!=n?a.videos.forEach(function(e,t){e.id==n&&(d=t)}):d++,i=a.videos[d],console.log("playNext: ",d,i),l.trigger("yt-player:play-by-id",{videoId:i.yt_video_id,startSeconds:i.start,endSeconds:i.end,suggestedQuality:"large"})}function t(e){e.forEach(function(e,t){console.log("btn",e,t),$('<div class="select-button" data-video-id="'+e.video_id+'">'+e.title+"<div>").appendTo(r).click(function(){e.click?e.click():o($(this).data("video-id"));r.addClass("list-player__buttons_hidden"),setTimeout(function(){r.empty().hide()},400)})}),r.show().removeClass("list-player__buttons_hidden")}var e=$(".list-player");if(e.length){var a,i,l=$(window),r=$(".list-player__buttons",e),s=0,d=-1;r.hide().addClass("list-player__buttons_hidden"),s++,l.on("page:ready",function(e,t){a=t,n()}),s++,l.on("yt-player:ready",function(e){n()}),l.on("yt-player:finished",function(e){console.log("FINISHED"),t(i.buttons)})}});